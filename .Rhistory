print('Logistic GAMs secound year:')
summary(gam2)
# Create data frame for firsst year plot
res_log1 = as.data.frame(summary(mdl1)$coefficients)
ci_1 = as.data.frame(confint.lm(mdl1, level = 0.9))
res_log1$lower_ci <- ci_1$`5 %`
res_log1$upper_ci <- ci_1$`95 %`
df_gam1 <- plot(getViz(gam1))$plots[[1]]$data$fit
df_gam1 <- df_gam1 %>% mutate(Birth_date = if_else(x< g1, 'Up to March19', ifelse(x<g2, 'March19 - March20', ifelse(x<g3,'March20 - Feb21','From Feb21'))))
df_gam1$Birth_date <- as.factor(df_gam1$Birth_date)
df_plot_1Y <- df_gam1 %>%
mutate(y_log = if_else(x < g1, 0, ifelse(x<g2, mdl1$coefficients['covid_time2'] ,
ifelse(x<g3 ,mdl1$coefficients['covid_time3'],
mdl1$coefficients['covid_time4']))),
ci_lower = if_else(x < g1, 0,
ifelse(x<g2, res_log1['covid_time2', 'lower_ci'],
ifelse(x<g3 , res_log1['covid_time3', 'lower_ci'],
res_log1['covid_time4', 'lower_ci']))),
ci_upper = if_else(x < g1, 0,
ifelse(x<g2, res_log1['covid_time2', 'upper_ci'],
ifelse(x<g3 , res_log1['covid_time3', 'upper_ci'],
res_log1['covid_time4', 'upper_ci']))))
#set dates
plus = min(as.numeric(as.Date(df$DOB)))
df_plot_1Y <- df_plot_1Y %>% mutate(Date = as.Date(x + plus,  origin = '1970-01-01'))
# Create data frame for eacound year plot
res_log2 = as.data.frame(summary(mdl2)$coefficients)
ci_2 = as.data.frame(confint.lm(mdl2, level = 0.9))
res_log2$lower_ci <- ci_2$`5 %`
res_log2$upper_ci <- ci_2$`95 %`
df_gam2 <- plot(getViz(gam2))$plots[[1]]$data$fit
df_gam2 <- df_gam2 %>% mutate(Birth_date = if_else(x< g1, 'Up to March19',
ifelse(x<g2, 'March19 - March20', ifelse(x<g3,'March20 - Feb21','From Feb21'))))
df_gam2$Birth_date <- as.factor(df_gam2$Birth_date)
df_plot_2Y <- df_gam2 %>% mutate(y_log = if_else(x < g1, 0,
ifelse(x<g2, mdl2$coefficients['covid_time2'] ,
ifelse(x<g3 ,mdl2$coefficients['covid_time3'],
mdl2$coefficients['covid_time4']))),
ci_lower = if_else(x < g1, 0,
ifelse(x<g2, res_log2['covid_time2', 'lower_ci'] ,
ifelse(x<g3 , res_log2['covid_time3', 'lower_ci'],
res_log2['covid_time4', 'lower_ci']))),
ci_upper = if_else(x < g1, 0,
ifelse(x<g2, res_log2['covid_time2', 'upper_ci'] ,
ifelse(x<g3 , res_log2['covid_time3', 'upper_ci'],
res_log2['covid_time4', 'upper_ci']))))
#set dates
plus = min(as.numeric(as.Date(df$DOB)))
df_plot_2Y <- df_plot_2Y %>% mutate(Date = as.Date(x + plus,  origin = '1970-01-01'))
# Log plot first year
log_plot1_first_year <- ggplot(df_plot_1Y, aes(Date,y, fill = Birth_date)) +
geom_line(aes(Date, y_log, col = Birth_date), size = 1) +
geom_ribbon(aes(ymin = ci_lower, ymax = ci_upper, y=NULL), alpha = 0.1)+
scale_color_manual(values=viridis(5)) + scale_fill_manual(values=viridis(5)) + theme_bw() +
labs(title = "Birth date group coefficient - Logistic standart model", subtitle ="During the first year of a baby's life", x = 'Birth date', y = 'Coefficient')+
geom_hline(yintercept = 0, linetype='dashed', alpha = 0.2, size=1) +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(legend.position = "none")
log_plot1_first_year
# Log plot second year
Log_plot2_second_year <- ggplot(df_plot_2Y, aes(Date, y, fill = Birth_date)) +
geom_line(aes(Date, y_log, col = Birth_date), size = 1) +
geom_ribbon(aes(ymin = ci_lower, ymax = ci_upper, y=NULL), alpha = 0.1)+
scale_color_manual(values=viridis(5)) + scale_fill_manual(values=viridis(5)) + theme_bw() +
labs(title = "Birth date group coefficient - Logistic standart model", subtitle ="During the second year of a baby's life", x = 'Birth date', y = 'Coefficient')+
geom_hline(yintercept = 0, linetype='dashed', alpha = 0.2, size=1)  +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(legend.position = "none")
Log_plot2_second_year
ggsave('First year - Logistic standart model.jpeg',log_plot1_first_year, width =8, height =6)
ggsave('Second year - Logistic standart model.jpeg',Log_plot2_second_year, width =8, height =6)
# Logistic GAMs plot fort year
GAM_plot1_first_year <- ggplot(df_plot_1Y, aes(Date,y, fill = Birth_date)) +
geom_line(aes(col = Birth_date), size = 1) +
geom_ribbon(aes(ymin = y - se*qnorm(0.95), ymax = y + se*qnorm(0.95), y=NULL), alpha = 0.1) +
scale_color_manual(values=viridis(5)) + scale_fill_manual(values=viridis(5)) + theme_bw() +
labs(title = "Birth date coefficient distribution - Logistic Generalized Additive Model", subtitle ="During the first year of a baby's life", x = 'Birth date', y = 'coefficient')+
geom_hline(yintercept = 0, linetype='dashed', alpha = 0.2) +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(legend.position = "none")
GAM_plot1_first_year
# Logistic GAMs plot second year
GAM_plot2_second_year <- ggplot(df_plot_2Y, aes(Date,y, fill = Birth_date)) +
geom_line(aes(col = Birth_date), size = 1) +
geom_ribbon(aes(ymin = y - se*qnorm(0.95), ymax = y + se*qnorm(0.95), y=NULL), alpha = 0.1) +
scale_color_manual(values=viridis(5)) + scale_fill_manual(values=viridis(5)) + theme_bw() +
labs(title = "Birth date coefficient distribution - Logistic Generalized Additive Model", subtitle ="During the second year of a baby's life", x = 'Birth date', y = 'coefficient')+
geom_hline(yintercept = 0, linetype='dashed', alpha = 0.2)  +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(legend.position = "none")
GAM_plot2_second_year
ggsave('First year - Logistic GAM.jpeg',GAM_plot1_first_year, width =8, height =6)
ggsave('Second year - Logistic GAM.jpeg',GAM_plot2_second_year, width =8, height =6)
# Creating prediction of atopic disease for typical person
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]}
n <- length(df_mdl$record_id) # number of rows in the data
# Data frame that contained the typical person n times in order to predict atopic diseas
typical_baby <- data.frame(SES_group = rep(getmode(SES_group),n),
gender = rep(getmode(gender),n),
type_of_pregnancy = rep(getmode(type_of_pregnancy),n),
feeding_type = rep(getmode(feeding_type),n),
mother_Atopic_diseases = rep(getmode(mother_Atopic_diseases),n),
father_Atopic_diseases = rep(getmode(father_Atopic_diseases),n),
mother_year_birth = rep(mean(df_mdl$mother_year_birth),n),
mother_education = rep(getmode(mother_education),n),
number_of_sibilings = rep(getmode(number_of_sibilings),n),
nursing_setup_at_12mo = rep(getmode(nursing_setup_at_12mo),n),
vaccine_12mo = rep(getmode(vaccine_12mo),n),
is_atopic_first_year = rep(getmode(is_atopic_first_year),n),
ABX_fisrt_year = rep(getmode(ABX_fisrt_year),n),
natural_delivery = rep(getmode(natural_delivery),n ))
# adding DOB for each observation
typical_baby <- typical_baby %>% mutate(DOB = df_mdl$DOB, DOB_count = df_mdl$DOB_count)
typical_baby <- typical_baby %>% mutate(Birth_date = if_else(DOB_count< g1, 'Up to March19', ifelse(DOB_count<g2, 'March19 - March20', ifelse(DOB_count<g3,'March20 - Feb21','From Feb21'))), covid_time = if_else(DOB_count< g1, 1, ifelse(DOB_count<g2, 2, ifelse(DOB_count<g3,3,4))))
typical_baby$covid_time <- as.factor(typical_baby$covid_time)
typical_baby_sick1 = typical_baby
# predict
typical_baby$gam_predict_first_year <- predict.gam(gam1, typical_baby, type = 'response')
typical_baby$gam_predict_second_year <- predict.gam(gam2, typical_baby, type = 'response')
typical_baby$reg_predict_first_year <- predict(mdl1, typical_baby, type = 'response')
typical_baby$reg_predict_second_year <- predict(mdl2, typical_baby, type = 'response')
typical_baby$gam_p_se1 <- predict.gam(gam1, typical_baby, type = 'response', se.fit=TRUE)$se.fit
typical_baby$gam_p_se2 <- predict.gam(gam2, typical_baby, type = 'response', se.fit=TRUE)$se.fit
typical_baby$reg_p_se1 <- predict(mdl1, typical_baby, type = 'response', se.fit=TRUE)$se.fit
typical_baby$reg_p_se2 <- predict(mdl2, typical_baby, type = 'response', se.fit=TRUE)$se.fit
# Plot the predictions :
typical_baby_plot1 <- ggplot(typical_baby, aes(DOB, gam_predict_first_year)) +
geom_line(aes(col = Birth_date, linetype='Logistic GAMs mdl'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_first_year - gam_p_se1*qnorm(0.95), ymax = gam_predict_first_year + gam_p_se1*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_first_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_first_year - reg_p_se1*qnorm(0.95), ymax = reg_predict_first_year + reg_p_se1*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the first year of a baby's life" , x = 'Birth date', y = 'Probability')  +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y")
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAMs mdl'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none")
ggsave('First year - Typical baby.jpeg',typical_baby_plot1, width =8, height =6)
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =8, height =6)
typical_baby_plot1
typical_baby_plot2
# separete graphs of prob :
prob_first_year_log <- ggplot(typical_baby, aes(DOB, gam_predict_first_year)) +
geom_line(aes(DOB, reg_predict_first_year, col = Birth_date), size = 1) +
geom_ribbon(aes(ymin = reg_predict_first_year - reg_p_se1*qnorm(0.95), ymax = reg_predict_first_year + reg_p_se1*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk - Logistic model", subtitle = "During the first year of a baby's life - Logistic model" , x = 'Birth date', y = 'Probability')  +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(legend.position = "none")
prob_first_year_log
prob_first_year_GAM <- ggplot(typical_baby, aes(DOB, gam_predict_first_year)) +
geom_line(aes(col = Birth_date), size = 1) +
geom_ribbon(aes(ymin = gam_predict_first_year - gam_p_se1*qnorm(0.95), ymax = gam_predict_first_year + gam_p_se1*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk - Logistic Generalized Additive Model", subtitle = "During the first year of a baby's life" , x = 'Birth date', y = 'Probability')  +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(legend.position = "none")
prob_first_year_GAM
prob_second_year_log <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk - Logistic model", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(legend.position = "none")
prob_second_year_log
prob_second_year_GAM <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(col = Birth_date), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk - Logistic Generalized Additive Model", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(legend.position = "none")
prob_second_year_GAM
ggsave('First year probability - Logistic standart model.jpeg',prob_first_year_log, width =8, height =6)
ggsave('First year probability - Logistic GAM.jpeg',prob_first_year_GAM, width =8, height =6)
ggsave('Second year probability - Logistic standart model.jpeg',prob_second_year_log, width =8, height =6)
ggsave('Second year probability - Logistic GAM.jpeg',prob_second_year_GAM, width =8, height =6)
ggsave('First year - Typical baby.jpeg',typical_baby_plot1, width =8, height =6)
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =8, height =6)
typical_baby_plot1
typical_baby_plot2
# Creating prediction of atopic disease for typical person
getmode <- function(v) {
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]}
n <- length(df_mdl$record_id) # number of rows in the data
# Data frame that contained the typical person n times in order to predict atopic diseas
typical_baby <- data.frame(SES_group = rep(getmode(SES_group),n),
gender = rep(getmode(gender),n),
type_of_pregnancy = rep(getmode(type_of_pregnancy),n),
feeding_type = rep(getmode(feeding_type),n),
mother_Atopic_diseases = rep(getmode(mother_Atopic_diseases),n),
father_Atopic_diseases = rep(getmode(father_Atopic_diseases),n),
mother_year_birth = rep(mean(df_mdl$mother_year_birth),n),
mother_education = rep(getmode(mother_education),n),
number_of_sibilings = rep(getmode(number_of_sibilings),n),
nursing_setup_at_12mo = rep(getmode(nursing_setup_at_12mo),n),
vaccine_12mo = rep(getmode(vaccine_12mo),n),
is_atopic_first_year = rep(getmode(is_atopic_first_year),n),
ABX_fisrt_year = rep(getmode(ABX_fisrt_year),n),
natural_delivery = rep(getmode(natural_delivery),n ))
# adding DOB for each observation
typical_baby <- typical_baby %>% mutate(DOB = df_mdl$DOB, DOB_count = df_mdl$DOB_count)
typical_baby <- typical_baby %>% mutate(Birth_date = if_else(DOB_count< g1, 'Up to March19', ifelse(DOB_count<g2, 'March19 - March20', ifelse(DOB_count<g3,'March20 - Feb21','From Feb21'))), covid_time = if_else(DOB_count< g1, 1, ifelse(DOB_count<g2, 2, ifelse(DOB_count<g3,3,4))))
typical_baby$covid_time <- as.factor(typical_baby$covid_time)
typical_baby_sick1 = typical_baby
# predict
typical_baby$gam_predict_first_year <- predict.gam(gam1, typical_baby, type = 'response')
typical_baby$gam_predict_second_year <- predict.gam(gam2, typical_baby, type = 'response')
typical_baby$reg_predict_first_year <- predict(mdl1, typical_baby, type = 'response')
typical_baby$reg_predict_second_year <- predict(mdl2, typical_baby, type = 'response')
typical_baby$gam_p_se1 <- predict.gam(gam1, typical_baby, type = 'response', se.fit=TRUE)$se.fit
typical_baby$gam_p_se2 <- predict.gam(gam2, typical_baby, type = 'response', se.fit=TRUE)$se.fit
typical_baby$reg_p_se1 <- predict(mdl1, typical_baby, type = 'response', se.fit=TRUE)$se.fit
typical_baby$reg_p_se2 <- predict(mdl2, typical_baby, type = 'response', se.fit=TRUE)$se.fit
# Plot the predictions :
typical_baby_plot1 <- ggplot(typical_baby, aes(DOB, gam_predict_first_year)) +
geom_line(aes(col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_first_year - gam_p_se1*qnorm(0.95), ymax = gam_predict_first_year + gam_p_se1*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_first_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_first_year - reg_p_se1*qnorm(0.95), ymax = reg_predict_first_year + reg_p_se1*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the first year of a baby's life" , x = 'Birth date', y = 'Probability')  +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y")
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none")
ggsave('First year - Typical baby.jpeg',typical_baby_plot1, width =8, height =6)
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =8, height =6)
typical_baby_plot1
typical_baby_plot2
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =10, height =6)
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", plot.background = element_rect(fill='transparent', color=NA))
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =10, height =6)
typical_baby_plot2
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none")
typical_baby_plot2
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", plot.background = element_rect(fill='NULL', color=NA))
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =10, height =6)
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", plot.background = element_rect(fill=NULL', color=NA))
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =10, height =6)
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", plot.background = element_rect(fill=NULL, color=NA))
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =10, height =6)
typical_baby_plot2
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", plot.background = element_rect(fill='transparent', color=NULL))
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =10, height =6)
typical_baby_plot2
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", panel.background = element_rect(fill='transparent'))
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =10, height =6)
typical_baby_plot2
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =10, height =6,  bg='transparent')
typical_baby_plot2
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", panel.background = element_blank())
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =10, height =6,  bg='transparent')
typical_baby_plot2
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", plot.background = element_rect(fill = "darkblue"))
typical_baby_plot2
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", plot.background = element_rect(fill = NULL))
typical_baby_plot2
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =10, height =6,  bg='transparent')
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", plot.background = element_blank())
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =10, height =6,  bg='transparent')
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =10, height =6)
typical_baby_plot2
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", plot.background = element_rect(fill = 'clear'))
typical_baby_plot2
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", plot.background = element_rect(fill = 'transparent'))
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =10, height =6,  bg='transparent')
typical_baby_plot2
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", plot.background = element_rect(fill = 'transparent')) + theme_transparent()
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", plot.background = element_rect(fill = 'transparent')) +ggpubr::theme_transparent()
ggpubr
install.packages('ggpubr')
library(ggpubr)
# install.packages('ggpubr')
library(ggpubr)
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", plot.background = element_rect(fill = 'transparent')) + ggpubr::theme_transparent()
typical_baby_plot2
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", plot.background = element_rect(fill = 'transparent')) + theme_transparent()
typical_baby_plot2
typical_baby_plot1
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", plot.background = element_rect(fill = 'Species')) + theme_transparent()
typical_baby_plot2
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", plot.background = element_rect(fill = 'Species'))
typical_baby_plot2
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", plot.background = element_rect(fill = 'transparent'))
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =10, height =6,  bg='transparent')
typical_baby_plot2
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", plot.background = element_rect(fill = 'transparent')) + theme_transparent()
typical_baby_plot2
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =10, height =6,  bg='transparent')
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", panel.background = element_rect(fill = "transparent", colour = NA))
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =10, height =6,  bg='transparent')
typical_baby_plot2
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", panel.background = element_rect(fill = "transparent", colour = NA))
typical_baby_plot2
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =10, height =6,  bg='transparent')
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw( panel.background = element_rect(fill = "transparent", colour = NA)) +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none")
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", panel.background = element_rect(fill = "transparent", colour = '#BFD5E3'))
typical_baby_plot2
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", panel.background = element_rect(fill = "transparent", colour = 'blue'))
typical_baby_plot2
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none")
ggsave('Second year - Typical baby.jpeg',typical_baby_plot2, width =10, height =6,  bg='transparent')
typical_baby_plot2
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_classic() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none")
typical_baby_plot2
typical_baby_plot2 <- ggplot(typical_baby, aes(DOB, gam_predict_second_year)) +
geom_line(aes(DOB, gam_predict_second_year, col = Birth_date, linetype='Logistic GAM'), size = 1) +
geom_ribbon(aes(ymin = gam_predict_second_year - gam_p_se2*qnorm(0.95), ymax = gam_predict_second_year + gam_p_se2*qnorm(0.95), y=NULL, fill=Birth_date), alpha=0.1)+
geom_line(aes(DOB, reg_predict_second_year, col = Birth_date, linetype = 'Logistic standart mdl'), size = 1) +
geom_ribbon(aes(ymin = reg_predict_second_year - reg_p_se2*qnorm(0.95), ymax = reg_predict_second_year + reg_p_se2*qnorm(0.95), y = NULL, fill = Birth_date), alpha=0.1)+
scale_color_manual(values=viridis(4)) + scale_fill_manual(values=viridis(4)) + theme_bw() +
labs(title = "Atopic disease risk", subtitle = "During the second year of a baby's life" , x = 'Birth date', y = 'Probability')   +
scale_x_date(date_breaks = "4 months", date_labels = "%b\n%y") + theme(text = element_text(size=20), legend.position = "none", panel.background = element_rect(fill = "transparent", colour = NA))
typical_baby_plot2
ggsave('Second year - Typical baby.png',typical_baby_plot2, width =10, height =6,  bg='transparent')
typical_baby_plot2
