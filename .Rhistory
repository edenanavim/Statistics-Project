df$gender[df$gender == 2] <- 0
df$`Jew/Arab`[df$`Jew/Arab` == 2] <- 0
df$food_allergy_24_month[df$food_allergy_24_month == 2] <- 0
df$inhalation_24_month[df$inhalation_24_month == 2] <- 0
df$prevention_therapy[df$prevention_therapy == 2] <- 0
df$AD_24_month[df$AD_24_month == 2] <- 0
df$steroids_treatment24[df$steroids_treatment24 == 2] <- 0
df$ABX_treatment_24_months[df$ABX_treatment_24_months == 2] <- 0
df$hospitalization_24_months[df$hospitalization_24_months == 2] <- 0
df$chronic_disease_24[df$chronic_disease_24 == 2] <- 0
#Changing NA to 0 for
df$number_ABX_treatment_24_months<- replace(df$number_ABX_treatment_24_months, is.na(df$number_ABX_treatment_24_months), 0)
df$hospitalization_24_months<- replace(df$hospitalization_24_months, is.na(df$hospitalization_24_months), 0)
df$prevention_therapy<- replace(df$prevention_therapy, is.na(df$prevention_therapy), 0)
df$number_inhalation<- replace(df$number_inhalation, is.na(df$number_inhalation), 0)
df$AD_treatment_24_month<- replace(df$AD_treatment_24_month, is.na(df$AD_treatment_24_month), 0)
df$steroids_treatment24<- replace(df$steroids_treatment24, is.na(df$steroids_treatment24), 0)
df$number_steroid_treat<- replace(df$number_steroid_treat
, is.na(df$number_steroid_treat), 0)
df$number_of_ABX_first_year<- replace(df$number_of_ABX_first_year, is.na(df$number_of_ABX_first_year), 0)
#Creating dependent variables:
#option A of explanatory var:
df <- df %>% mutate(is_atopic_first_year = ifelse((AD_first_year + FA_first_year + ABX_fisrt_year)>0,1,0), is_atopic_second_year = ifelse((food_allergy_24_month + inhalation_24_month + AD_24_month)>0,1,0))
#option B of explanatory var:
#From mail
#Choosing explanatory variables: Ones that have a sufficient number of observation before and after Corona
#The distribution of observations according to the timeline of the corona. Before the corona = 1, the first six months of the corona = 2  and after = 3:
covid_start_date <- as.Date("2020-01-30")
covid_mid_date <- as.Date("2020-07-30")
df <- df %>% mutate(covid_time = ifelse(DOB < covid_start_date,1,ifelse(DOB < covid_mid_date, 2,3)))
df[,c("DOB","covid_time")]
table(df$covid_time)
df[,c("DOB","covid_time")]
table(df$covid_time)
unique(df$DOB)
min(df$DOB)
df <- df %>% mutate(covid_time = ifelse(DOB < group1,1,ifelse(DOB < group2, 2,ifelse(DOB<group3, 3, 4))))
#Choosing explanatory variables: Ones that have a sufficient number of observation before and after Corona
#The distribution of observations according to the timeline of the corona. Before the corona = 1, the first six months of the corona = 2  and after = 3:
min(df$DOB)
group1 <- as.Date("2019-03-01")
group2 <- as.Date("2020-03-11")
group3 <- as.Date("2021-02-07")
df <- df %>% mutate(covid_time = ifelse(DOB < group1,1,ifelse(DOB < group2, 2,ifelse(DOB<group3, 3, 4))))
# df[,c("DOB","covid_time")]
table(df$covid_time)
df <- df %>% mutate(covid_time = ifelse(DOB < group1, 1, ifelse(DOB < group2, 2, ifelse(DOB<group3, 3, 4))))
df
unique(df$DOB)
max(df$DOB)
# Reading the file:
# dir <- "C:/Users/Merav/Documents/GitHub/Statistics-Project/atopic_comorbidities_first_second_year_3.1.23_raw.xlsx"
#dir <- "C:/Users/edena/Documents/GitHub/Statistics-Project/atopic_comorbidities_first_second_year_3.1.23_raw.xlsx"
dir<-"C:/Users/Shahar/Documents/GitHub/Statistics-Project/atopic_comorbidities_first_second_year_3.1.23_raw.xlsx"
df <- read_excel(dir, sheet = 1)
# Reading the file:
# dir <- "C:/Users/Merav/Documents/GitHub/Statistics-Project/atopic_comorbidities_first_second_year_3.1.23.xlsx"
#dir <- "C:/Users/edena/Documents/GitHub/Statistics-Project/atopic_comorbidities_first_second_year_3.1.23.xlsx"
dir<-"C:/Users/Shahar/Documents/GitHub/Statistics-Project/atopic_comorbidities_first_second_year_3.1.23.xlsx"
# Reading the file:
# dir <- "C:/Users/Merav/Documents/GitHub/Statistics-Project/atopic_comorbidities_first_second_year_3.1.23.xlsx"
#dir <- "C:/Users/edena/Documents/GitHub/Statistics-Project/atopic_comorbidities_first_second_year_3.1.23.xlsx"
dir<-"C:/Users/Shahar/Documents/GitHub/Statistics-Project/atopic_comorbidities_first_second_year_3.1.23.xlsx"
df <- read_excel(dir, sheet = 1)
df <- df %>% mutate(DOB = as.Date(DOB))
# Arranging df:
# Filtering only participants that completed the survey:
df <- df %>% filter(is.na(lost_of_followup))
# Filtering only participants that completed the second year:
df <- df %>% filter(month_survey_complete == 2)
# Removing non relevant columns: from type_of_allergy to 12_month_FA_type_allergy
#remove_columns = colnames(df)[51:88]
df <- df[,-c(51:88)]
# Removing columns with allot on NA:
not_relevant <- c('allergist_followup', 'last_spt', 'epipen', 'mistake_exposure', 'reaction_type24', 'diagnosis_by', 'lost_of_followup')
df <- df[-which(colnames(df) %in% not_relevant)]
# Adding binary columns
# A. Did any one from family (mother, father, sib) have *any* of the disease?
df$family_Atopic_diseases_sum <- rowSums(df[,14:49])
# B. Did somebody from family have a specific disease?
# NEED TO FILL IN
# C. Did a disease appear in a specific family member?
df$mother_Atopic_diseases_sum <- rowSums(df[,14:19])
df$father_Atopic_diseases_sum <- rowSums(df[,20:25])
df$sibling_Atopic_diseases_sum <- rowSums(df[,26:49])
df <- df %>% mutate(family_Atopic_diseases = ifelse(family_Atopic_diseases_sum >0,1,0),
mother_Atopic_diseases = ifelse(mother_Atopic_diseases_sum>0,1,0),
father_Atopic_diseases = ifelse(father_Atopic_diseases_sum > 0, 1,0),
sibling_Atopic_diseases = ifelse(sibling_Atopic_diseases_sum > 0 ,1, 0))
# Changing to binary variables:
df$gender[df$gender == 2] <- 0
df$`Jew/Arab`[df$`Jew/Arab` == 2] <- 0
df$food_allergy_24_month[df$food_allergy_24_month == 2] <- 0
df$inhalation_24_month[df$inhalation_24_month == 2] <- 0
df$prevention_therapy[df$prevention_therapy == 2] <- 0
df$AD_24_month[df$AD_24_month == 2] <- 0
df$steroids_treatment24[df$steroids_treatment24 == 2] <- 0
df$ABX_treatment_24_months[df$ABX_treatment_24_months == 2] <- 0
df$hospitalization_24_months[df$hospitalization_24_months == 2] <- 0
df$chronic_disease_24[df$chronic_disease_24 == 2] <- 0
#Changing NA to 0 for
df$number_ABX_treatment_24_months<- replace(df$number_ABX_treatment_24_months, is.na(df$number_ABX_treatment_24_months), 0)
df$hospitalization_24_months<- replace(df$hospitalization_24_months, is.na(df$hospitalization_24_months), 0)
df$prevention_therapy<- replace(df$prevention_therapy, is.na(df$prevention_therapy), 0)
df$number_inhalation<- replace(df$number_inhalation, is.na(df$number_inhalation), 0)
df$AD_treatment_24_month<- replace(df$AD_treatment_24_month, is.na(df$AD_treatment_24_month), 0)
df$steroids_treatment24<- replace(df$steroids_treatment24, is.na(df$steroids_treatment24), 0)
df$number_steroid_treat<- replace(df$number_steroid_treat
, is.na(df$number_steroid_treat), 0)
df$number_of_ABX_first_year<- replace(df$number_of_ABX_first_year, is.na(df$number_of_ABX_first_year), 0)
#Creating dependent variables:
#option A of explanatory var:
df <- df %>% mutate(is_atopic_first_year = ifelse((AD_first_year + FA_first_year + ABX_fisrt_year)>0,1,0), is_atopic_second_year = ifelse((food_allergy_24_month + inhalation_24_month + AD_24_month)>0,1,0))
#option B of explanatory var:
#From mail
#Choosing explanatory variables: Ones that have a sufficient number of observation before and after Corona
#The distribution of observations according to the timeline of the corona. Before the corona = 1, the first six months of the corona = 2  and after = 3:
group1 <- as.Date("2019-03-01")
group2 <- as.Date("2020-03-11")
group3 <- as.Date("2021-02-07")
df <- df %>% mutate(covid_time = ifelse(DOB < group1, 1, ifelse(DOB < group2, 2, ifelse(DOB<group3, 3, 4))))
# df[,c("DOB","covid_time")]
table(df$covid_time)
max(df$DOB)
# Taking a first view at data:
summary(df)
glimpse(df)
# attach(df)
# One strange observation- gave birth at 12??
df[which(df$mother_year_birth> 2000),] # to take off ??
# Taking a first view at data:
summary(df)
glimpse(df)
# attach(df)
# One strange observation- gave birth at 12??
df[which(df$mother_year_birth> 2000),] # to take off ??
mean(df$AD_first_year)
df$AD_first_year
df[which(colnames(df) == 'DOB') == 4]
df[which(colnames(df) == 'DOB') == 1]
df[which(colnames(df) == 'DOB') == 1,]
df[,which(colnames(df) == 'DOB')]
df[,which(colnames(df) == 'covid_time')]
df[,which(colnames(df) == 'covid_time') ==1]
df[,which(colnames(df) == 'covid_time') == 1]
df[which(colnames(df) == 'covid_time') == 1,]
df[which(colnames(df) == 'covid_time')]
df[which(colnames(df) == 'covid_time')== 1]
df[,which(colnames(df) == 'covid_time') == 1]
df[which(df$covid_time == 1]
df[which(df$covid_time == 1)]
df[which(df$covid_time == 1),]
df[which(df$covid_time == 1),'AD_first_year']
mean(df[which(df$covid_time == 1),'AD_first_year'])
df[which(df$covid_time == 1),'AD_first_year']
mean(df[which(df$covid_time == 1),'AD_first_year'])
mean(df[which(df$covid_time == 1),'AD_first_year']$AD_first_year)
mean(df[which(df$covid_time == 1),]$AD_first_year)
mean(df[which(df$covid_time == 2),]$AD_first_year)
mean(df[which(df$covid_time == 3),]$AD_first_year)
mean(df[which(df$covid_time == 1),]$AD_first_year)
mean(df[which(df$covid_time == 2),]$AD_first_year)
mean(df[which(df$covid_time == 3),]$AD_first_year)
var(df[which(df$covid_time == 3),]$AD_first_year)
var(df[which(df$covid_time == 1),]$AD_first_year)
var(df[which(df$covid_time == 2),]$AD_first_year)
var(df[which(df$covid_time == 3),]$AD_first_year)
mean(df[which(df$covid_time == 1),]$FA_first_year)
mean(df[which(df$covid_time == 2),]$FA_first_year)
mean(df[which(df$covid_time == 3),]$FA_first_year)
mean(df[which(df$covid_time == 1),]$HRAD_first_year)
mean(df[which(df$covid_time == 2),]$HRAD_first_year)
mean(df[which(df$covid_time == 3),]$HRAD_first_year)
mean(df[which(df$covid_time == 1),]$is_atopic_second_year)
mean(df[which(df$covid_time == 2),]$is_atopic_second_year)
mean(df[which(df$covid_time == 3),]$is_atopic_second_year)
df[which(df$covid_time == 3),]$is_atopic_second_year
mean(df[which(df$covid_time == 1),]$is_atopic_second_year, na.rm = T)
mean(df[which(df$covid_time == 2),]$is_atopic_second_year, na.rm = T)
mean(df[which(df$covid_time == 3),]$is_atopic_second_year, na.rm = T)
# libraries:
library(readxl)
library(dplyr)
library(ggplot2)
library(tidyr)
library(reshape)
library(glue)
options(scipen=5, digits = 5)
# Reading the file:
# dir <- "C:/Users/Merav/Documents/GitHub/Statistics-Project/atopic_comorbidities_first_second_year_3.1.23.xlsx"
# dir <- "C:/Users/edena/Documents/GitHub/Statistics-Project/atopic_comorbidities_first_second_year_3.1.23.xlsx"
dir<-"C:/Users/Shahar/Documents/GitHub/Statistics-Project/atopic_comorbidities_first_second_year_3.1.23.xlsx"
df <- read_excel(dir, sheet = 1)
df <- df %>% mutate(DOB = as.Date(DOB))
# Arranging df:
# Filtering only participants that completed the survey:
df <- df %>% filter(is.na(lost_of_followup))
# Filtering only participants that completed the second year:
df <- df %>% filter(month_survey_complete == 2)
# Removing non relevant columns: from type_of_allergy to 12_month_FA_type_allergy
#remove_columns = colnames(df)[51:88]
df <- df[,-c(51:88)]
# Removing columns with allot on NA:
not_relevant <- c('allergist_followup', 'last_spt', 'epipen', 'mistake_exposure', 'reaction_type24', 'diagnosis_by', 'lost_of_followup',"mother_no_comorbidities","mother_other","father_no_comorbidities","father_other","sibling1_other","sibling1_no_comorbidities","sibling2_other","sibling2_no_comorbidities","sibling3_other","sibling3_no_comorbidities","sibling4_other","sibling4_no_comorbidities")
df <- df[-which(colnames(df) %in% not_relevant)]
# Adding binary columns
# A. Did any one from family (mother, father, sib) have *any* of the disease?
df$family_Atopic_diseases_sum <- rowSums(df[,14:37])
# B. Did somebody from family have a specific disease?
# NEED TO FILL IN
# C. Did a disease appear in a specific family member?
df$mother_Atopic_diseases_sum <- rowSums(df[,14:17])
df$father_Atopic_diseases_sum <- rowSums(df[,18:21])
df$sibling_Atopic_diseases_sum <- rowSums(df[,22:37])
df <- df %>% mutate(family_Atopic_diseases = ifelse(family_Atopic_diseases_sum >0,1,0),
mother_Atopic_diseases = ifelse(mother_Atopic_diseases_sum>0,1,0),
father_Atopic_diseases = ifelse(father_Atopic_diseases_sum > 0, 1,0),
sibling_Atopic_diseases = ifelse(sibling_Atopic_diseases_sum > 0 ,1, 0))
# Changing to binary variables:
df$gender[df$gender == 2] <- 0
df$`Jew/Arab`[df$`Jew/Arab` == 2] <- 0
df$food_allergy_24_month[df$food_allergy_24_month == 2] <- 0
df$inhalation_24_month[df$inhalation_24_month == 2] <- 0
df$prevention_therapy[df$prevention_therapy == 2] <- 0
df$AD_24_month[df$AD_24_month == 2] <- 0
df$steroids_treatment24[df$steroids_treatment24 == 2] <- 0
df$ABX_treatment_24_months[df$ABX_treatment_24_months == 2] <- 0
df$hospitalization_24_months[df$hospitalization_24_months == 2] <- 0
df$chronic_disease_24[df$chronic_disease_24 == 2] <- 0
df$type_of_pregnancy[df$type_of_pregnancy == 2] <- 0
#Changing NA to 0 for
df$number_ABX_treatment_24_months<- replace(df$number_ABX_treatment_24_months, is.na(df$number_ABX_treatment_24_months), 0)
df$hospitalization_24_months<- replace(df$hospitalization_24_months, is.na(df$hospitalization_24_months), 0)
df$prevention_therapy<- replace(df$prevention_therapy, is.na(df$prevention_therapy), 0)
df$number_inhalation<- replace(df$number_inhalation, is.na(df$number_inhalation), 0)
df$AD_treatment_24_month<- replace(df$AD_treatment_24_month, is.na(df$AD_treatment_24_month), 0)
df$steroids_treatment24<- replace(df$steroids_treatment24, is.na(df$steroids_treatment24), 0)
df$number_steroid_treat<- replace(df$number_steroid_treat
, is.na(df$number_steroid_treat), 0)
df$number_of_ABX_first_year<- replace(df$number_of_ABX_first_year, is.na(df$number_of_ABX_first_year), 0)
#Creating dependent variables:
#option A of explanatory var:
df <- df %>% mutate(is_atopic_first_year = ifelse((AD_first_year + FA_first_year + ABX_fisrt_year)>0,1,0), is_atopic_second_year = ifelse((food_allergy_24_month + inhalation_24_month + AD_24_month)>0,1,0))
#option B of explanatory var:
#From mail
#Choosing explanatory variables: Ones that have a sufficient number of observation before and after Corona
#The distribution of observations according to the timeline of the corona. Before the corona = 1, the first six months of the corona = 2  and after = 3:
group1 <- as.Date("2019-03-01")
group2 <- as.Date("2020-03-11")
group3 <- as.Date("2021-02-07")
df <- df %>% mutate(covid_time = ifelse(DOB < group1, 1, ifelse(DOB < group2, 2, ifelse(DOB<group3, 3, 4))))
table(df$covid_time)
# at this moment there is no sutible data from group 4 - post corona
# mean(df[which(df$covid_time == 1),]$is_atopic_second_year, na.rm = T)
# mean(df[which(df$covid_time == 2),]$is_atopic_second_year, na.rm = T)
# mean(df[which(df$covid_time == 3),]$is_atopic_second_year, na.rm = T)
# Taking a first view at data:
summary(df)
glimpse(df)
# attach(df)
# One strange observation- gave birth at 12??
df[which(df$mother_year_birth> 2000),] # to take off ??
attach(df) ##מה זה? -- יוצר משתנה עבור כל עמודה בפנה עצמה בלי קשר לדאטה
# Show the distribution of some variables
hist(mother_year_birth)
hist(SES) #socio-economic status
# Frequency table for each column
tablelist <- mapply(table, df)
#tablelist
# How many NA are in each column
NA_count <- as.data.frame(t(df %>% summarise_all(funs(sum(is.na(.)))))) %>% dplyr::rename("amount of NA" = 1)
NA_count <- NA_count %>% mutate(Name = rownames(NA_count))
NA_column = NA_count %>% filter(`amount of NA` >0) %>% arrange(`amount of NA`)
#For each explanatory variable:
print("SES")
table(df$covid_time,df$SES)
print("gender")
table(df$covid_time,df$gender)
print("mother_education")
table(df$covid_time,df$mother_education)
print("preganancy_number")
table(df$covid_time,df$preganancy_number)
print("type_of_pregnancy")
table(df$covid_time,df$type_of_pregnancy)
print("mode of delivery")
table(df$covid_time,df$`mode of delivery`)
df <- df %>% drop_na(AD_first_year, FA_first_year, ABX_fisrt_year,food_allergy_24_month, inhalation_24_month, AD_24_month)
plot_df_1 <- df %>% select(covid_time, AD_first_year, AD_24_month, FA_first_year,food_allergy_24_month, ABX_fisrt_year,inhalation_24_month) %>% group_by(covid_time) %>% summarise(AD_first_year = sum(AD_first_year), AD_24_month = sum(AD_24_month), FA_first_year = sum(FA_first_year),food_allergy_24_month = sum(food_allergy_24_month), ABX_fisrt_year = sum(ABX_fisrt_year),inhalation_24_month = sum(inhalation_24_month)) %>% gather(chronic_disease, count, AD_first_year:inhalation_24_month, factor_key=TRUE)
plot_df_2 <- df %>% select(covid_time,is_atopic_first_year,is_atopic_second_year) %>% group_by(covid_time) %>% summarise(is_atopic_first_year= sum(is_atopic_first_year), is_atopic_second_year= sum(is_atopic_second_year)) %>% gather(chronic_disease, count, is_atopic_first_year:is_atopic_second_year, factor_key=TRUE)
ggplot(plot_df_1,aes(x=chronic_disease, y= count, fill = as.factor(covid_time))) +
geom_col() + xlab("Chronic Disease") + ylab("Cases") +
scale_fill_manual(values=c('dodgerblue4', 'darkorange1', 'green4'),name = "Group")
ggplot(plot_df_2,aes(x=chronic_disease, y= count, fill = as.factor(covid_time))) +
geom_col(position = "dodge") + scale_fill_discrete(name = "Group")+ xlab("Chronic Disease") + ylab("Cases") +
scale_fill_manual(values=c('dodgerblue4', 'darkorange1', 'green4'))
ggplot(data=df, aes(x=SES, group= as.factor(is_atopic_first_year), fill=as.factor(is_atopic_first_year))) +
geom_density(adjust=1.5, alpha=.4)
ggplot(data=df, aes(x=SES, group= as.factor(AD_first_year), fill=as.factor(AD_first_year))) +
geom_density(adjust=1.5, alpha=.4)
ggplot(data=df, aes(x=SES, group= as.factor(is_atopic_second_year), fill=as.factor(is_atopic_second_year))) +
geom_density(adjust=1.5, alpha=.4)
plot_df_3 <- df %>% select(SES,is_atopic_first_year,is_atopic_second_year) %>% drop_na() %>% group_by(SES) %>% summarise(is_atopic_first_year= sum(is_atopic_first_year), is_atopic_second_year= sum(is_atopic_second_year)) %>% gather(chronic_disease, count, is_atopic_first_year:is_atopic_second_year, factor_key=TRUE)
plot_df_3 <- df %>% select(SES,is_atopic_first_year,is_atopic_second_year) %>% drop_na() %>% group_by(SES) %>% summarise(is_atopic_first_year= mean(is_atopic_first_year), is_atopic_second_year= mean(is_atopic_second_year)) %>% gather(chronic_disease, count, is_atopic_first_year:is_atopic_second_year, factor_key=TRUE)
ggplot(plot_df_3,aes(x=as.factor(SES), y= count, fill = as.factor(chronic_disease))) +
geom_col(position = "dodge") + scale_fill_discrete(name = "Group")+ xlab("SES") + ylab("Cases") +
scale_fill_manual(values=c('dodgerblue4', 'darkorange1', 'green4'))
table(SES)
ggplot(data=df%>% mutate(mother_age = 2023 - mother_year_birth), aes(x=mother_age, group= as.factor(is_atopic_first_year), fill=as.factor(is_atopic_first_year))) +
geom_density(adjust=1.5, alpha=.4)
ggplot(data=df%>% mutate(mother_age = 2023 - mother_year_birth), aes(x=mother_age, group= as.factor(is_atopic_second_year), fill=as.factor(is_atopic_second_year))) +
geom_density(adjust=1.5, alpha=.4)
ggplot(data=df%>% mutate(mother_age = 2023 - mother_year_birth), aes(x=mother_age, group= as.factor(AD_first_year), fill=as.factor(AD_first_year))) +
geom_density(adjust=1.5, alpha=.4)
ggplot(data=df%>% mutate(mother_age = 2023 - mother_year_birth), aes(x=mother_age, group= as.factor(AD_24_month), fill=as.factor(AD_24_month))) +
geom_density(adjust=1.5, alpha=.4)
ggplot(data=df%>% mutate(mother_age = 2023 - mother_year_birth), aes(x=mother_age, group= as.factor(FA_first_year), fill=as.factor(FA_first_year))) +
geom_density(adjust=1.5, alpha=.4)
ggplot(data=df%>% mutate(mother_age = 2023 - mother_year_birth), aes(x=mother_age, group= as.factor(food_allergy_24_month), fill=as.factor(food_allergy_24_month))) +
geom_density(adjust=1.5, alpha=.4)
ggplot(data=df%>% mutate(mother_age = 2023 - mother_year_birth), aes(x=mother_age, group= as.factor(ABX_fisrt_year), fill=as.factor(ABX_fisrt_year))) +
geom_density(adjust=1.5, alpha=.4)
ggplot(data=df%>% mutate(mother_age = 2023 - mother_year_birth), aes(x=mother_age, group= as.factor(inhalation_24_month), fill=as.factor(inhalation_24_month))) +
geom_density(adjust=1.5, alpha=.4)
ggplot(data=df%>% mutate(mother_age = 2023 - mother_year_birth), aes(x=as.factor(is_atopic_first_year), y=mother_age)) +
geom_boxplot()
ggplot(data=df%>% mutate(mother_age = 2023 - mother_year_birth), aes(x=as.factor(is_atopic_second_year), y=mother_age)) +
geom_boxplot()
ggplot(data=df%>% mutate(mother_age = 2023 - mother_year_birth), aes(x=as.factor(AD_first_year), y=mother_age)) +
geom_boxplot()
ggplot(data=df%>% mutate(mother_age = 2023 - mother_year_birth), aes(x=as.factor(AD_24_month), y=mother_age)) +
geom_boxplot()
ggplot(data=df%>% mutate(mother_age = 2023 - mother_year_birth), aes(x=as.factor(FA_first_year), y=mother_age)) +
geom_boxplot()
ggplot(data=df%>% mutate(mother_age = 2023 - mother_year_birth), aes(x=as.factor(food_allergy_24_month), y=mother_age)) +
geom_boxplot()
ggplot(data=df%>% mutate(mother_age = 2023 - mother_year_birth), aes(x=as.factor(ABX_fisrt_year), y=mother_age)) +
geom_boxplot()
ggplot(data=df%>% mutate(mother_age = 2023 - mother_year_birth), aes(x=as.factor(inhalation_24_month), y=mother_age)) +
geom_boxplot()
plot_df_4 <- df %>% select(mother_education,is_atopic_first_year,is_atopic_second_year,AD_first_year, AD_24_month, FA_first_year,food_allergy_24_month, ABX_fisrt_year,inhalation_24_month) %>% drop_na() %>% group_by(mother_education) %>% summarise(is_atopic_first_year= mean(is_atopic_first_year), is_atopic_second_year= mean(is_atopic_second_year),AD_first_year = mean(AD_first_year), AD_24_month = mean(AD_24_month), FA_first_year = mean(FA_first_year),food_allergy_24_month = mean(food_allergy_24_month), ABX_fisrt_year = mean(ABX_fisrt_year),inhalation_24_month = mean(inhalation_24_month)) %>% gather(chronic_disease, mean, is_atopic_first_year:inhalation_24_month, factor_key=TRUE)
ggplot(plot_df_4,aes(x=as.factor(chronic_disease), y= mean, fill = as.factor(mother_education))) +
geom_col(position = "dodge") + scale_fill_discrete(name = "mother_education")+ xlab("mother_education") + ylab("percent diseas") #+scale_fill_manual(values=c('dodgerblue4', 'darkorange1', 'green4'))
plot_df_5 <- df %>% select(number_of_children,is_atopic_first_year,is_atopic_second_year,AD_first_year, AD_24_month, FA_first_year,food_allergy_24_month, ABX_fisrt_year,inhalation_24_month) %>% drop_na() %>% group_by(number_of_children) %>% summarise(is_atopic_first_year= mean(is_atopic_first_year), is_atopic_second_year= mean(is_atopic_second_year),AD_first_year = mean(AD_first_year), AD_24_month = mean(AD_24_month), FA_first_year = mean(FA_first_year),food_allergy_24_month = mean(food_allergy_24_month), ABX_fisrt_year = mean(ABX_fisrt_year),inhalation_24_month = mean(inhalation_24_month)) %>% gather(chronic_disease, mean, is_atopic_first_year:inhalation_24_month, factor_key=TRUE)
ggplot(plot_df_5,aes(x=as.factor(chronic_disease), y= mean, fill = as.factor(number_of_children))) +
geom_col(position = "dodge") + scale_fill_discrete(name = "number_of_children")+ xlab("chronic_disease") + ylab("percent of disease")# +scale_fill_manual(values=c('dodgerblue4', 'darkorange1', 'green4'))
plot_df_6 <- df %>% select(preganancy_number,is_atopic_first_year,is_atopic_second_year,AD_first_year, AD_24_month, FA_first_year,food_allergy_24_month, ABX_fisrt_year,inhalation_24_month) %>% drop_na() %>% group_by(preganancy_number) %>% summarise(is_atopic_first_year= mean(is_atopic_first_year), is_atopic_second_year= mean(is_atopic_second_year),AD_first_year = mean(AD_first_year), AD_24_month = mean(AD_24_month), FA_first_year = mean(FA_first_year),food_allergy_24_month = mean(food_allergy_24_month), ABX_fisrt_year = mean(ABX_fisrt_year),inhalation_24_month = mean(inhalation_24_month)) %>% gather(chronic_disease, mean, is_atopic_first_year:inhalation_24_month, factor_key=TRUE)
ggplot(plot_df_6,aes(x=as.factor(chronic_disease), y= mean, fill = as.factor(preganancy_number))) +
geom_col(position = "dodge") + scale_fill_discrete(name = "preganancy_number")+ xlab("chronic_disease") + ylab("percent of disease")# +scale_fill_manual(values=c('dodgerblue4', 'darkorange1', 'green4'))
plot_df_7 <- df %>% select(type_of_pregnancy,is_atopic_first_year,is_atopic_second_year,AD_first_year, AD_24_month, FA_first_year,food_allergy_24_month, ABX_fisrt_year,inhalation_24_month) %>% drop_na() %>% group_by(type_of_pregnancy) %>% summarise(is_atopic_first_year= mean(is_atopic_first_year), is_atopic_second_year= mean(is_atopic_second_year),AD_first_year = mean(AD_first_year), AD_24_month = mean(AD_24_month), FA_first_year = mean(FA_first_year),food_allergy_24_month = mean(food_allergy_24_month), ABX_fisrt_year = mean(ABX_fisrt_year),inhalation_24_month = mean(inhalation_24_month)) %>% gather(chronic_disease, mean, is_atopic_first_year:inhalation_24_month, factor_key=TRUE)
ggplot(plot_df_7,aes(x=as.factor(chronic_disease), y= mean, fill = as.factor(type_of_pregnancy))) +
geom_col(position = "dodge") + scale_fill_discrete(name = "type_of_pregnancy")+ xlab("chronic_disease") + ylab("percent of disease")# +scale_fill_manual(values=c('dodgerblue4', 'darkorange1', 'green4'))
plot_df_8 <- df %>% select(number_ABX_treatment_24_months,is_atopic_first_year,is_atopic_second_year,AD_first_year, AD_24_month, FA_first_year,food_allergy_24_month, ABX_fisrt_year,inhalation_24_month) %>% drop_na() %>% group_by(number_ABX_treatment_24_months) %>% summarise(is_atopic_first_year= mean(is_atopic_first_year), is_atopic_second_year= mean(is_atopic_second_year),AD_first_year = mean(AD_first_year), AD_24_month = mean(AD_24_month), FA_first_year = mean(FA_first_year),food_allergy_24_month = mean(food_allergy_24_month), ABX_fisrt_year = mean(ABX_fisrt_year),inhalation_24_month = mean(inhalation_24_month)) %>% gather(chronic_disease, mean, is_atopic_first_year:inhalation_24_month, factor_key=TRUE)
ggplot(plot_df_8,aes(x=as.factor(chronic_disease), y= mean, fill = as.factor(number_ABX_treatment_24_months))) +
geom_col(position = "dodge") + scale_fill_discrete(name = "number_ABX_treatment_24_months")+ xlab("chronic_disease") + ylab("percent of disease")# +scale_fill_manual(values=c('dodgerblue4', 'darkorange1', 'green4'))
explanatory_variables <- df %>% select(mother_year_birth,SES, Jew/Arab,DOB, gender, mother_education, number_of_children, preganancy_number,type_of_pregnancy,Allergy_total,mother_asthma,mother_atopic_dermatitis,mother_Allergic_rhinitis,mother_food_allergy,father_asthma,father_atopic_dermatitis,father_Allergic_rhinitis,father_food_allergy,sibling1_asthma,sibling1_atopic_dermatitis,sibling1_Allergic_rhinitis,sibling1_food_allergy,sibling2_asthma,sibling2_atopic_dermatitis,sibling2_Allergic_rhinitis,sibling2_food_allergy,sibling3_asthma,sibling3_atopic_dermatitis,sibling3_Allergic_rhinitis,sibling3_food_allergy,sibling4_asthma,sibling4_atopic_dermatitis,sibling4_Allergic_rhinitis,sibling4_food_allergy,HRAD_first_year,AD_first_year,FA_first_year,ABX_fisrt_year, number_of_ABX_first_year,vaccine_12mo,nursing_setup_at_12mo,daycare_24month,vaccines_24month,food_allergy_24_month,inhalation_24_month,number_inhalation,prevention_therapy,AD_24_month,AD_treatment_24_month,steroids_treatment24,number_steroid_treat,chronic_rhinitis_24_month,ABX_treatment_24_months,number_ABX_treatment_24_months,hospitalization_24_months,chronic_disease_24,month_survey_complete,family_Atopic_diseases_sum,mother_Atopic_diseases_sum,father_Atopic_diseases_sum,sibling_Atopic_diseases_sum, family_Atopic_diseases,mother_Atopic_diseases,father_Atopic_diseases,sibling_Atopic_diseases,is_atopic_first_year,is_atopic_second_year,covid_time)
explanatory_variables <- df %>% select(mother_year_birth,SES, Jew/Arab,DOB, gender, mother_education, number_of_children, preganancy_number,type_of_pregnancy,Allergy_total,mother_asthma,mother_atopic_dermatitis,mother_Allergic_rhinitis,mother_food_allergy,father_asthma,father_atopic_dermatitis,father_Allergic_rhinitis,father_food_allergy,sibling1_asthma,sibling1_atopic_dermatitis,sibling1_Allergic_rhinitis,sibling1_food_allergy,sibling2_asthma,sibling2_atopic_dermatitis,sibling2_Allergic_rhinitis,sibling2_food_allergy,sibling3_asthma,sibling3_atopic_dermatitis,sibling3_Allergic_rhinitis,sibling3_food_allergy,sibling4_asthma,sibling4_atopic_dermatitis,sibling4_Allergic_rhinitis,sibling4_food_allergy,HRAD_first_year,AD_first_year,FA_first_year,ABX_fisrt_year, number_of_ABX_first_year,vaccine_12mo,nursing_setup_at_12mo,daycare_24month,vaccines_24month,food_allergy_24_month,inhalation_24_month,number_inhalation,prevention_therapy,AD_24_month,AD_treatment_24_month,steroids_treatment24,number_steroid_treat,chronic_rhinitis_24_month,ABX_treatment_24_months,number_ABX_treatment_24_months,hospitalization_24_months,chronic_disease_24,month_survey_complete,family_Atopic_diseases_sum,mother_Atopic_diseases_sum,father_Atopic_diseases_sum,sibling_Atopic_diseases_sum, family_Atopic_diseases,mother_Atopic_diseases,father_Atopic_diseases,sibling_Atopic_diseases,is_atopic_first_year,is_atopic_second_year,covid_time)
explanatory_variables <- df %>% select(mother_year_birth,SES, `Jew/Arab`,DOB, gender, mother_education, number_of_children, preganancy_number,type_of_pregnancy,Allergy_total,mother_asthma,mother_atopic_dermatitis,mother_Allergic_rhinitis,mother_food_allergy,father_asthma,father_atopic_dermatitis,father_Allergic_rhinitis,father_food_allergy,sibling1_asthma,sibling1_atopic_dermatitis,sibling1_Allergic_rhinitis,sibling1_food_allergy,sibling2_asthma,sibling2_atopic_dermatitis,sibling2_Allergic_rhinitis,sibling2_food_allergy,sibling3_asthma,sibling3_atopic_dermatitis,sibling3_Allergic_rhinitis,sibling3_food_allergy,sibling4_asthma,sibling4_atopic_dermatitis,sibling4_Allergic_rhinitis,sibling4_food_allergy,HRAD_first_year,AD_first_year,FA_first_year,ABX_fisrt_year, number_of_ABX_first_year,vaccine_12mo,nursing_setup_at_12mo,daycare_24month,vaccines_24month,food_allergy_24_month,inhalation_24_month,number_inhalation,prevention_therapy,AD_24_month,AD_treatment_24_month,steroids_treatment24,number_steroid_treat,chronic_rhinitis_24_month,ABX_treatment_24_months,number_ABX_treatment_24_months,hospitalization_24_months,chronic_disease_24,month_survey_complete,family_Atopic_diseases_sum,mother_Atopic_diseases_sum,father_Atopic_diseases_sum,sibling_Atopic_diseases_sum, family_Atopic_diseases,mother_Atopic_diseases,father_Atopic_diseases,sibling_Atopic_diseases,is_atopic_first_year,is_atopic_second_year,covid_time)
explanatory_variables <- df %>% select(mother_year_birth,SES, `Jew/Arab`,DOB, gender, mother_education, number_of_children, preganancy_number,type_of_pregnancy,Allergy_total,mother_asthma,mother_atopic_dermatitis,mother_Allergic_rhinitis,mother_food_allergy,father_asthma,father_atopic_dermatitis,father_Allergic_rhinitis,father_food_allergy,sibling1_asthma,sibling1_atopic_dermatitis,sibling1_Allergic_rhinitis,sibling1_food_allergy,sibling2_asthma,sibling2_atopic_dermatitis,sibling2_Allergic_rhinitis,sibling2_food_allergy,sibling3_asthma,sibling3_atopic_dermatitis,sibling3_Allergic_rhinitis,sibling3_food_allergy,sibling4_asthma,sibling4_atopic_dermatitis,sibling4_Allergic_rhinitis,sibling4_food_allergy,HRAD_first_year,AD_first_year,FA_first_year,ABX_fisrt_year, number_of_ABX_first_year,vaccine_12mo,nursing_setup_at_12mo,daycare_24month,vaccines_24month,food_allergy_24_month,inhalation_24_month,number_inhalation,prevention_therapy,AD_24_month,AD_treatment_24_month,steroids_treatment24,number_steroid_treat,chronic_rhinitis_24_month,ABX_treatment_24_months,number_ABX_treatment_24_months,hospitalization_24_months,chronic_disease_24,month_survey_complete,family_Atopic_diseases_sum,mother_Atopic_diseases_sum,father_Atopic_diseases_sum,sibling_Atopic_diseases_sum, family_Atopic_diseases,mother_Atopic_diseases,father_Atopic_diseases,sibling_Atopic_diseases,is_atopic_first_year,is_atopic_second_year,covid_time)
explanatory_variables
explanatory_variables
ggplot(df, aes(x=DOB, group = as.factor(AD_first_year), fill=as.factor(AD_first_year))) +geom_density()
ggplot(df, aes(x=DOB, group = as.factor(AD_first_year), fill=as.factor(AD_first_year))) + geom_density(adjust=1.5, alpha=.4)
continues_explanatory <- function(kpi){
return (ggplot(df, aes(x=DOB, group = as.factor(kpi), fill=as.factor(kpi))) + geom_density(adjust=1.5, alpha=.4))  }
continues_explanatory(AD_first_year)
continues_explanatory('AD_first_year')
return (ggplot(df, aes(x=DOB, group = as.factor(.df[[kpi]]), fill=as.factor(.df[[kpi]]))) + geom_density(adjust=1.5, alpha=.4))  }
continues_explanatory <- function(kpi){
return (ggplot(df, aes(x=DOB, group = as.factor(.df[[kpi]]), fill=as.factor(.df[[kpi]]))) + geom_density(adjust=1.5, alpha=.4))  }
continues_explanatory('AD_first_year')
attach(df)
continues_explanatory <- function(kpi){
return (ggplot(df, aes(x=DOB, group = as.factor(kpi), fill=as.factor(kpi))) + geom_density(adjust=1.5, alpha=.4))  }
continues_explanatory(AD_first_year)
exloretory_variables = list(AD_first_year, AD_24_month, FA_first_year, food_allergy_24_month, ABX_fisrt_year, inhalation_24_month, is_atopic_first_year, is_atopic_second_year)
for kpi in exloretory_variables{ continues_explanatory(kpi)}
for kpi in exloretory_variables{ continues_explanatory(kpi)}
for (kpi in exloretory_variables){ continues_explanatory(kpi)}
lapply(exloretory_variables, continues_explanatory)
attach(df)
continues_explanatory <- function(kpi){
return (ggplot(df, aes(x=DOB, group = as.factor(kpi), fill=as.factor(kpi))) + geom_density(adjust=1.5, alpha=.4)) + labs(title = str(kpi)) }
exloretory_variables = list(AD_first_year, AD_24_month, FA_first_year, food_allergy_24_month, ABX_fisrt_year, inhalation_24_month, is_atopic_first_year, is_atopic_second_year)
lapply(exloretory_variables, continues_explanatory)
attach(df)
continues_explanatory <- function(kpi){
return (ggplot(df, aes(x=DOB, group = as.factor(kpi), fill=as.factor(kpi))) + geom_density(adjust=1.5, alpha=.4)) + labs(title = as.character(kpi)) }
exloretory_variables = list(AD_first_year, AD_24_month, FA_first_year, food_allergy_24_month, ABX_fisrt_year, inhalation_24_month, is_atopic_first_year, is_atopic_second_year)
lapply(exloretory_variables, continues_explanatory)
return (ggplot(df, aes(x=DOB, group = as.factor(kpi), fill=as.factor(kpi))) + geom_density(adjust=1.5, alpha=.4)) + labs(title = paste0(kpi)) }
attach(df)
continues_explanatory <- function(kpi){
return (ggplot(df, aes(x=DOB, group = as.factor(kpi), fill=as.factor(kpi))) + geom_density(adjust=1.5, alpha=.4)) + labs(title = paste0(kpi)) }
exloretory_variables = list(AD_first_year, AD_24_month, FA_first_year, food_allergy_24_month, ABX_fisrt_year, inhalation_24_month, is_atopic_first_year, is_atopic_second_year)
lapply(exloretory_variables, continues_explanatory)
attach(df)
continues_explanatory <- function(kpi){
return (ggplot(df, aes(x=DOB, group = as.factor(kpi), fill=as.factor(kpi))) + geom_density(adjust=1.5, alpha=.4)) + labs(title = paste0(as.character(kpi))) }
exloretory_variables = list(AD_first_year, AD_24_month, FA_first_year, food_allergy_24_month, ABX_fisrt_year, inhalation_24_month, is_atopic_first_year, is_atopic_second_year)
lapply(exloretory_variables, continues_explanatory)
continues_explanatory <- function(kpi){
return (ggplot(df, aes(x=DOB, group = as.factor(kpi), fill=as.factor(kpi))) + geom_density(adjust=1.5, alpha=.4)) + labs(title = paste0(as.character(kpi))) }
exloretory_variables = list(AD_first_year, AD_24_month, FA_first_year, food_allergy_24_month, ABX_fisrt_year, inhalation_24_month, is_atopic_first_year, is_atopic_second_year)
lapply(exloretory_variables, continues_explanatory)
continues_explanatory <- function(kpi){
paste0(as.character(kpi))
return (ggplot(df, aes(x=DOB, group = as.factor(kpi), fill=as.factor(kpi))) + geom_density(adjust=1.5, alpha=.4)) + labs(title = paste0(as.character(kpi))) }
exloretory_variables = list(AD_first_year, AD_24_month, FA_first_year, food_allergy_24_month, ABX_fisrt_year, inhalation_24_month, is_atopic_first_year, is_atopic_second_year)
lapply(exloretory_variables, continues_explanatory)
continues_explanatory <- function(kpi){
return (kpi) }
exloretory_variables = list(AD_first_year, AD_24_month, FA_first_year, food_allergy_24_month, ABX_fisrt_year, inhalation_24_month, is_atopic_first_year, is_atopic_second_year)
lapply(exloretory_variables, continues_explanatory)
continues_explanatory <- function(kpi){
return (character(kpi)) }
lapply(exloretory_variables, continues_explanatory)
continues_explanatory <- function(kpi){
return (character(kpi)) }
lapply(exloretory_variables, continues_explanatory)
continues_explanatory <- function(kpi){
return (print(as.character(kpi))) }
lapply(exloretory_variables, continues_explanatory)
continues_explanatory <- function(kpi){
return (print(colnames(kpi))) }
lapply(exloretory_variables, continues_explanatory)
exloretory_variables = list(AD_first_year, AD_24_month, FA_first_year, food_allergy_24_month, ABX_fisrt_year, inhalation_24_month, is_atopic_first_year, is_atopic_second_year)
explanatory_names = list('AD_first_year', 'AD_24_month', 'FA_first_year', 'food_allergy_24_month', 'ABX_fisrt_year', 'inhalation_24_month', 'is_atopic_first_year', 'is_atopic_second_year')
continues_explanatory <- function(kpi, name){
return (print(name)) }
lapply((exloretory_variables, explanatory_names), continues_explanatory)
lapply(c(exloretory_variables, explanatory_names), continues_explanatory)
continues_explanatory <- function(kpi, name){
return (print(name)) }
lapply(c(exloretory_variables, explanatory_names), continues_explanatory)
exloretory_variables <- c(AD_24_month, 'AD_24_month')
continues_explanatory <- function(kpi, name){
return (print(name)) }
lapply(c(exloretory_variables), continues_explanatory)
exloretory_variables <- c(c(AD_24_month, 'AD_24_month'))
continues_explanatory <- function(kpi, name){
return (print(name)) }
lapply(c(exloretory_variables), continues_explanatory)
continues_explanatory <- function(kpi, name){
return (print(name)) }
lapply(c(exloretory_variables), continues_explanatory)
return (print(kpi[2])) }
continues_explanatory <- function(kpi){
return (print(kpi[2])) }
lapply(c(exloretory_variables), continues_explanatory)
exloretory_variables
exloretory_variables <- c(c(AD_24_month, 'AD_24_month'))
exloretory_variables
exloretory_variables <- c(AD_24_month, 'AD_24_month')
exloretory_variables
exloretory_variables = list(AD_first_year, AD_24_month, FA_first_year, food_allergy_24_month, ABX_fisrt_year, inhalation_24_month, is_atopic_first_year, is_atopic_second_year)
continues_explanatory <- function(kpi){
return (ggplot(df, aes(x=DOB, group = as.factor(kpi), fill=as.factor(kpi))) + geom_density(adjust=1.5, alpha=.4)) + labs(title = paste0(as.character(kpi))) }
lapply(c(exloretory_variables), continues_explanatory)
lapply(c(exloretory_variables), continues_explanatory)
exloretory_variables
ggplot(data=df%>% mutate(mother_age = 2023 - mother_year_birth), aes(x=mother_age, group= as.factor(AD_first_year), fill=as.factor(AD_first_year))) +
geom_density(adjust=1.5, alpha=.4)
attach(df)
exloretory_variables = list(AD_first_year, AD_24_month, FA_first_year, food_allergy_24_month, ABX_fisrt_year, inhalation_24_month, is_atopic_first_year, is_atopic_second_year)
continues_explanatory <- function(kpi){
return (ggplot(df, aes(x=DOB, group = as.factor(kpi), fill=as.factor(kpi))) + geom_density(adjust=1.5, alpha=.4)) + labs(title = paste0(as.character(kpi))) }
lapply(c(exloretory_variables), continues_explanatory)
attach(df)
exloretory_variables = list(AD_first_year, AD_24_month, FA_first_year, food_allergy_24_month, ABX_fisrt_year, inhalation_24_month, is_atopic_first_year, is_atopic_second_year)
continues_explanatory <- function(kpi){
return (ggplot(df, aes(x=DOB, group = as.factor(kpi), fill=as.factor(kpi))) + geom_density(adjust=1.5, alpha=.4)) + labs(title = paste0(as.character(kpi))) }
lapply(c(exloretory_variables), continues_explanatory)
exloretory_variables = list(AD_first_year, AD_24_month, FA_first_year, food_allergy_24_month, ABX_fisrt_year, inhalation_24_month, is_atopic_first_year, is_atopic_second_year)
continues_explanatory <- function(kpi){
return (ggplot(df, aes(x=DOB, group = as.factor(kpi), fill=as.factor(kpi))) + geom_density(adjust=1.5, alpha=.4)) + labs(title = paste0(as.character(kpi))) }
lapply(c(exloretory_variables), continues_explanatory)
df['AD_first_year']
.df['AD_first_year']
df['AD_first_year']
df[['AD_first_year']]
continues_explanatory('AD_first_year')
return (ggplot(df, aes(x=DOB, group = as.factor(df[kpi]), fill=as.factor(df[kpi]))) + geom_density(adjust=1.5, alpha=.4)) }
continues_explanatory <- function(kpi){
return (ggplot(df, aes(x=DOB, group = as.factor(df[kpi]), fill=as.factor(df[kpi]))) + geom_density(adjust=1.5, alpha=.4)) }
continues_explanatory('AD_first_year')
return (ggplot(df, aes(x=DOB, group = as.factor(df[[kpi]]), fill=as.factor(df[[kpi]]))) + geom_density(adjust=1.5, alpha=.4)) }
continues_explanatory <- function(kpi){
return (ggplot(df, aes(x=DOB, group = as.factor(df[[kpi]]), fill=as.factor(df[[kpi]]))) + geom_density(adjust=1.5, alpha=.4)) }
continues_explanatory('AD_first_year')
continues_explanatory <- function(kpi){
return (ggplot(df, aes(x=DOB, group = as.factor(df[[kpi]]), fill=as.factor(df[[kpi]]))) + geom_density(adjust=1.5, alpha=.4)) + labs(title = kpi) }
continues_explanatory('AD_first_year')
continues_explanatory <- function(kpi){
return (ggplot(df, aes(x=DOB, group = as.factor(df[[kpi]]), fill=as.factor(df[[kpi]]))) + geom_density(adjust=1.5, alpha=.4)) + ggtitle(kpi) }
continues_explanatory('AD_first_year')
kpi = 'AD_first_year'
ggplot(df, aes(x=DOB, group = as.factor(df[[kpi]]), fill=as.factor(df[[kpi]]))) + geom_density(adjust=1.5, alpha=.4)) + ggtitle(kpi)
ggplot(df, aes(x=DOB, group = as.factor(df[[kpi]]), fill=as.factor(df[[kpi]]))) + geom_density(adjust=1.5, alpha=.4)+ ggtitle(kpi)
continues_explanatory <- function(kpi){
continues_explanatory('AD_first_year')
continues_explanatory <- function(kpi){
return (ggplot(df, aes(x=DOB, group = as.factor(df[[kpi]]), fill=as.factor(df[[kpi]]))) + geom_density(adjust=1.5, alpha=.4) + ggtitle(kpi)) }
continues_explanatory('AD_first_year')
continues_explanatory('AD_first_year')
continues_explanatory('AD_first_year')
continues_explanatory <- function(kpi){
return (ggplot(df, aes(x=DOB, group = as.factor(df[[kpi]]), fill=as.factor(df[[kpi]]))) + geom_density(adjust=1.5, alpha=.4) + ggtitle(kpi)) }
continues_explanatory('AD_first_year')
lapply(c(exloretory_variables), continues_explanatory)
kpi = 'AD_first_year'
ggplot(df, aes(x=DOB, group = as.factor(df[[kpi]]), fill=as.factor(df[[kpi]]))) + geom_density(adjust=1.5, alpha=.4)+ ggtitle(kpi)
ggplot(df, aes(x=DOB, group = as.factor(df[[kpi]]), fill=as.factor(df[[kpi]]))) + geom_density(adjust=1.5, alpha=.4)+ ggtitle(kpi)
